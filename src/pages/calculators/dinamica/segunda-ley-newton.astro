---
import CalculatorLayout from "../../../layouts/CalculatorLayout.astro";
import CalculatorHeader from "../../../components/calculator/CalculatorHeader.astro";
import VariableSelector from "../../../components/calculator/VariableSelector.astro";
import InputGroup from "../../../components/calculator/InputGroup.astro";
import ResultDisplay from "../../../components/calculator/ResultDisplay.astro";
import FormulasContainer from "../../../components/calculator/FormulasContainer.astro";
import FormulaItem from "../../../components/calculator/FormulaItem.astro";
import InfoMessage from "../../../components/calculator/InfoMessage.astro";
import MultipleForces from "../../../components/calculator/MultipleForces.astro";
import { 
  NEWTON_SECOND_LAW_VARIABLES, 
  NEWTON_SECOND_LAW_FORMULAS,
  NEWTON_MULTIPLE_FORCES_VARIABLES,
  NEWTON_MULTIPLE_FORCES_FORMULAS, 
  UNITS 
} from "../../../constants/calculator";
import '../../../styles/calculator-components.css';
import '../../../styles/calculator-unified.css';
import '../../../styles/mcu.css';
import '../../../styles/multiple-forces.css';
---

<CalculatorLayout title="Segunda Ley de Newton" description="Calculadora para la Segunda Ley de Newton (F = ma)">
  <h1>Segunda Ley de Newton</h1>
  
  <InfoMessage type="info">
    La Segunda Ley de Newton establece que la fuerza resultante aplicada a un objeto es directamente proporcional a su aceleraci칩n y a su masa. <strong>춰Ahora con soporte para m칰ltiples fuerzas!</strong>
  </InfoMessage>
  
  <p>
    La Segunda Ley de Newton, tambi칠n conocida como Ley Fundamental de la Din치mica, establece que la aceleraci칩n de un objeto es directamente proporcional a la fuerza neta aplicada sobre 칠l e inversamente proporcional a su masa. Esta ley se expresa matem치ticamente como <strong>F = m 칑 a</strong>, donde F es la fuerza resultante, m es la masa del objeto y a es la aceleraci칩n producida.
  </p>

  <!-- Selector de modo de c치lculo -->
  <div class="calculation-mode-selector">
    <h3>Modo de C치lculo:</h3>
    <div class="mode-buttons">
      <button type="button" class="mode-btn active" id="basic-mode-btn" onclick="switchCalculationMode('basic')">
        <span class="icon">丘뒲잺</span>
        <div class="mode-info">
          <strong>B치sico</strong>
          <small>Una sola fuerza</small>
        </div>
      </button>
      <button type="button" class="mode-btn" id="multiple-mode-btn" onclick="switchCalculationMode('multipleForces')">
        <span class="icon">游꿢</span>
        <div class="mode-info">
          <strong>M칰ltiples Fuerzas</strong>
          <small>Varias fuerzas simult치neas</small>
        </div>
      </button>
    </div>
  </div>
  
  <div class="calculator-container">
    <div class="calculator">
      <CalculatorHeader 
        title="Calculadora Segunda Ley de Newton" 
        description="Selecciona la inc칩gnita que deseas calcular y completa los valores conocidos"
        icon="丘뒲잺"
      />
      
      <div class="calculator-body">
        <VariableSelector 
          options={NEWTON_SECOND_LAW_VARIABLES} 
          label="Variable a calcular:"
          id="variable-selector"
        />
        
        <!-- Modo b치sico: Inputs tradicionales -->
        <div id="basic-inputs" class="input-mode active">
          <div class="input-groups-container">
            <InputGroup 
              id="force" 
              label="Fuerza (F):" 
              placeholder="Ingresa la fuerza" 
              units={UNITS.force} 
            />
            
            <InputGroup 
              id="mass" 
              label="Masa (m):" 
              placeholder="Ingresa la masa" 
              units={UNITS.mass} 
            />
            
            <InputGroup 
              id="acceleration" 
              label="Aceleraci칩n (a):" 
              placeholder="Ingresa la aceleraci칩n" 
              units={UNITS.acceleration} 
            />
          </div>
        </div>

        <!-- Modo m칰ltiples fuerzas -->
        <div id="multiple-forces-inputs" class="input-mode">
          <div class="example-container">
            <button type="button" class="example-btn" id="load-example-btn">
              <span class="example-icon">游눠</span>
              Cargar ejemplo: Dos fuerzas perpendiculares
            </button>
          </div>
          
          <MultipleForces id="multiple-forces" />
          
          <div class="input-groups-container">
            <InputGroup 
              id="mass-multiple" 
              label="Masa (m):" 
              placeholder="Ingresa la masa del objeto" 
              units={UNITS.mass} 
            />
            
            <InputGroup 
              id="acceleration-multiple" 
              label="Aceleraci칩n (a):" 
              placeholder="Ingresa la aceleraci칩n (si es conocida)" 
              units={UNITS.acceleration} 
            />
          </div>
        </div>
        
        <button id="calculate-btn" class="calculate-button">Calcular</button>
        
        <ResultDisplay showCopyButton={true} />
      </div>
    </div>
    
    <FormulasContainer 
      title="F칩rmulas de la Segunda Ley de Newton"
      icon="游늵"
    >
      <div id="basic-formulas" class="formulas-section active">
        <h4>F칩rmulas B치sicas:</h4>
        {NEWTON_SECOND_LAW_FORMULAS.map(formula => (
          <FormulaItem 
            formula={formula.formula} 
            description={formula.description}
            example={formula.formula === 'F = m 칑 a' ? 'F = 10 kg 칑 2 m/s = 20 N' : 
                     formula.formula === 'a = F / m' ? 'a = 20 N / 10 kg = 2 m/s' :
                     formula.formula === 'm = F / a' ? 'm = 20 N / 2 m/s = 10 kg' : undefined} 
          />
        ))}
      </div>

      <div id="multiple-formulas" class="formulas-section">
        <h4>F칩rmulas para M칰ltiples Fuerzas:</h4>
        {NEWTON_MULTIPLE_FORCES_FORMULAS.map(formula => (
          <FormulaItem 
            formula={formula.formula} 
            description={formula.description}
            example={formula.example} 
          />
        ))}
      </div>
    </FormulasContainer>
  </div>

  <script>
    import { setupCalculator } from "../../../utils/calculators/calculator-controller";
    import { calculateNewtonAuto } from "../../../utils/calculators/integrated-newton-calculator";
    import { NEWTON_SECOND_LAW_CONFIG } from "../../../constants/calculator";
    import { initResponsiveUtils } from "../../../utils/responsive-utils";
    
    document.addEventListener('DOMContentLoaded', function() {
      // Configurar la calculadora con funci칩n integrada
      setupCalculator({
        calculateFunction: (variableToSolve, values) => {
          try {
            return calculateNewtonAuto(variableToSolve, values);
          } catch (error) {
            console.error('Error en c치lculo:', error);
            throw error;
          }
        },
        variableGroups: NEWTON_SECOND_LAW_CONFIG.variableGroups
      });
      
      // Inicializar utilidades responsivas
      initResponsiveUtils();
    });
  </script>
  
  <!-- Load the mode controller script -->
  <script src="../../../utils/calculators/newton-mode-controller.js"></script>
</CalculatorLayout>